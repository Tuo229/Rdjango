{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/font-awesome-line-awesome/css/all.min.css">
    <link rel="stylesheet" href="path/to/line-awesome/css/line-awesome-font-awesome.min.css">

    <link rel="stylesheet" href="{% static './immob/css/style.css'%}" />

    <title>Afrique Immobilier</title>
    <style>
        {% block styles %}

        {% endblock styles %}
    </style>
  </head>
  <body>
    <div class=''>
        <div class='row content'>

            <div class="col-sm cls-sm">
                
                {% if log == True %}
                  <a href="{% url 'immob:Logout' %}" type="button" class="btn btn-outline-secondary">Deconnexion</a>
                  <a href="#" type="button" class="btn btn-outline-secondary">{{user}}</a>
                {% else %}
                  <!--<a href="#" type="button" class="btn btn-outline-secondary">Inscription</a>-->
                  <button type="button" class="btn btn-outline-secondary" data-toggle="modal" data-target="#signup" data-whatever="@mdo">Inscription</button>
                  <!--<a href="{% url 'immob:Login' %}" type="button" class="btn btn-outline-secondary">Connexion</a>-->
                  <button type="button" class="btn btn-outline-secondary" data-toggle="modal" data-target="#login" data-whatever="@mdo">Connexion</button>
                {% endif%}
            </div>
            <div class="col-sm">
                <center>
                    <strong>AFRIQUE</strong><span style='color: orange;'> IMMOBILIER</span>
                    <p><strong style='color: #aaa;'>VOTRE BIEN ETRE, NOTRE SOUCI</strong></center></p>
                </center>
            </div>
            <div class="col-sm">
                <i class="fas fa-cloud"></i>
                <i class="fas fa-coffee"></i>
                
            </div>

        </div>
        <hr>
        <header>
            <nav>
                <ul class="nav justify-content-center">
                    <li class="nav-item">
                    <a class="nav-link text-dark" href="{% url 'immob:index' %}">ACCUEIL</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link text-dark" href="#">NOS SERVICES</a>
                    </li>
                    <li class="nav-item">
                        <div class="dropdown">
                            <a type="button" class="dropdown-toggle drop" data-toggle="dropdown">
                              OPPORTUNITES
                            </a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item" href="{% url 'immob:biens' %}">MES POSTES</a>
                              <a class="dropdown-item" href="#">POSTES DES AUTRES</a>
                            </div>
                          </div>
                        
                    </li>
                    <li class="nav-item">
                        <div class="dropdown">
                            <a type="button" class="dropdown-toggle drop" data-toggle="dropdown">
                              BESOINS
                            </a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item" href="#">MES BESOINS</a>
                              <a class="dropdown-item" href="#">BESOINS DES AUTRES</a>
                            </div>
                          </div>
                        
                    </li>
                    <li class="nav-item">
                    <a class="nav-link text-dark" href="#">CONTACTS</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link text-dark" href="#">RECHERCHER UN BIEN</a>
                    </li>
                    <li class="nav-item">
                      <a class=" btn btn-dark nav-link bg-warning text-white" style="border: none;" href="#">POSTER VOTRE BIEN</a>
                    </li>
                </ul>
            </nav>
        </header>
       
       {% block hr_br %}
        <br>
       {% endblock hr_br %}
       
    </div>

    
    <div class="modal fade" id="login" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Connexion</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form method="POST">
              {% csrf_token %}
              <div class="form-group">
                <label for="email" class="col-form-label">Email:</label>
                <input type="email" class="form-control" id="email">
              </div>
              <div class="form-group">
                <label for="password" class="col-form-label">Mot de passe:</label>
                <input type="password" class="form-control" id="password">
              </div>
              <div id="errorlogin" style="color:red"></div>
              <div class="modal-footer">
                <button type="button" id="sub" class="btn btn-outline-secondary" value="Se connecter">Se connecter</button>
              </div>
            </form>
          </div>
          
        </div>
      </div>
    </div>

    <div class="modal fade" id="signup" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Inscription</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form method="POST">
              {% csrf_token %}
              <div class="form-group">
                <label for="id_username" class="col-form-label">{{userForm.username.label}}</label>
                {{ userForm.username }}
              </div>
              <div class="form-group">
                <label for="id_email" class="col-form-label">{{userForm.email.label}}</label>
                {{ userForm.email }}
              </div>
              <div class="form-group">
                <label for="id_phone" class="col-form-label">{{userForm.phone.label}}</label>
                {{ userForm.phone }}
              </div>
              <div class="form-group">
                <label for="id_password" class="col-form-label">{{userForm.password.label}}</label>
                {{ userForm.password }}
              </div>
              <div class="form-group">
                <label for="id_password1" class="col-form-label">{{userForm.password1.label}}</label>
                {{ userForm.password1 }}
              </div>
              <div class="form-check">
                <label for="id_news" class="form-check-label">{{userForm.news.label}}</label>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  {{ userForm.news }}
              </div>
              
              <div id="errorlogins" style="color:red"></div>
              <div class="modal-footer">
                <button type="button" id="signup" class="btn btn-outline-secondary" value="">S'inscrire</button>
              </div>
            </form>
          </div>
          
        </div>
      </div>
    </div>

    {% block content %}
        {% block search %}
        
        {% endblock search %}
    {% endblock content %}


    <footer class="mt-5 bg-warning">
        <div class="row">
          <div class="col-sm"></div>
          <div class="col-sm">
            <center>
              <p><a href="#">Afrique Immobilier</a></p>
              <p><a href="#">immobafric@gmail.com</a></p>
            </center>
          </div>
          <div class="col-sm"></div>
        </div>
      </footer>


    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    
    
    <script>

        var login = document.getElementById('login')
        login.addEventListener('show.bs.modal', function (event) {
          // Button that triggered the modal
          var button = event.relatedTarget
          // Extract info from data-bs-* attributes
          var recipient = button.getAttribute('data-bs-whatever')
          // If necessary, you could initiate an AJAX request here
          // and then do the updating in a callback.
          //
          // Update the modal's content.
          var modalTitle = login.querySelector('.modal-title')
          var modalBodyInput = login.querySelector('.modal-body input')

          modalTitle.textContent = 'New message to ' + recipient
          modalBodyInput.value = recipient
        });

        var signup = document.getElementById('signup')
        signup.addEventListener('show.bs.modal', function (event) {
          // Button that triggered the modal
          var button = event.relatedTarget
          // Extract info from data-bs-* attributes
          var recipient = button.getAttribute('data-bs-whatever')
          // If necessary, you could initiate an AJAX request here
          // and then do the updating in a callback.
          //
          // Update the modal's content.
          var modalTitle = signup.querySelector('.modal-title')
          var modalBodyInput = signup.querySelector('.modal-body input')

          modalTitle.textContent = 'New message to ' + recipient
          modalBodyInput.value = recipient
        });

        $(document).ready(function(){
          $("#sub").click(function(){
            email = document.getElementById("email").value;
            password = document.getElementById("password").value;
            csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
            $("#errorlogin").html("");
            $.ajax({
              type: 'POST',
              url: "{% url 'immob:Login' %}/",
              data: {
                'csrfmiddlewaretoken': csrfmiddlewaretoken,
                'email': email,
                'password': password,
              },
              success: function(data){
                console.log(data);
                if (data['message'] == "Success"){
                  location.reload();
                }else if (data['message'] == 'inactive'){
                  $("#errorlogin").html("S'il vous plait veillez verifier votre mail !");
                }else{
                  $("#errorlogin").html("Votre mot de passe ou email est incorrecte !");
                }
              }
            });
            })

            /*Registration*/
          $("#signup").click(function(){
            username = document.getElementById("id_username").value;
            email = document.getElementById("id_email").value;
            phone = document.getElementById("id_phone").value;
            password = document.getElementById("id_password").value;
            password1 = document.getElementById("id_password1").value;
            news = document.getElementById("id_news").value;
            csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
            $("#errorlogins").html("");
            $.ajax({
              type: 'POST',
              url: "{% url 'immob:register' %}/",
              data: {
                'csrfmiddlewaretoken': csrfmiddlewaretoken,
                'username': username,
                'email': email,
                'phone': phone,
                'password': password,
                'password1':password1,
                'news':news,
              },
              success: function(data){
                console.log(data);
                if (data['message'] == "Success"){
                  location.reload();
                }else if (data['message'] == 'Incomplete'){
                  $("#errorlogins").html("Vous n'avez pas bien renseigné le formulaire !");
                }else{
                  $("#errorlogins").html("Vous n'avez pas soumi de data !");
                }
              }
            });
            })
        });

        {% block script %}

        {% endblock script %}
    </script>
</body>
</html>